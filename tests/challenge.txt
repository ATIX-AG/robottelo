*** settings ***    *** Value ***

Documentation   Suite using WebDriver API.

Resource        ../resources/environments.txt
Resource        ../resources/global.txt
Resource        ../resources/organizations.txt
Resource        ../resources/roles.txt
Resource        ../resources/users.txt

Library         ../lib/administration.py
Library         ../lib/common.py
Library         ../lib/login.py     ${BASE_URL}    ${BROWSER}
Library         ../lib/org.py
Library         ../lib/systems.py

Test Teardown   Stop Browser

*** Test Case ***

Create user Akihito
    [Documentation]  As the administrator, create user Akihito.
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Create User     Akihito     redhat    akihito@somecorp.com
Create user Homer
    [Documentation]  As the administrator, create user Homer.
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Create User     Homer     redhat    springfield_d00d@somecorp.com
Create Role Asia ReadOnly Admin
    [Documentation]  As the administrator, create role Asia ReadOnly Admin.
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Create Role      Asia ReadOnly Admin
    Add Permission To Role  Asia ReadOnly Admin    global   Organizations
    ...    Read Organization   acme_read_orgs
Create Role Puppet Master
    [Documentation]  As the administrator, create Puppet Master.
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Create Role     Puppet Master
    Add Permission To Role  Puppet Master   global  Users
    ...     Modify Users    cat_herder
Add Role To user Akihito
    [Documentation]  As the administrator, add Asia ReadOnly Admin to user Akihito.
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Add Role To User    Asia ReadOnly Admin    Akihito
Add Role To user Homer
    [Documentation]  As the administrator, add Puppet Master to user Homer.
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Add Role To User    Puppet Master    Homer
Login user Akihito
    [Documentation]  Log in as user Akihito and perform actions.
    Login User      Akihito     redhat
    Select Org      ACME_Corporation
    Switch To Org   ACME_Corporation
    ${access}=      Go To Administration Tab
    Run Keyword And Continue On Failure   Should Not Be True  ${access}
    ${access}=      Go To Systems Tab
    Run Keyword And Continue On Failure   Should Not Be True  ${access}
Login user Homer
    [Documentation]  Log in as user Homer and perform actions.
    Login User      Homer     redhat
    ${access}=      Go To Administration Tab
    Run Keyword And Continue On Failure   Should Be True  ${access}
    ${access}=      Go To Organizations Tab
    Run Keyword And Continue On Failure   Should Not Be True  ${access}
    ${access}=      Go To Systems Tab
    Run Keyword And Continue On Failure   Should Not Be True  ${access}
Remove Role From user Akihito
    [Documentation]  Removes Role from user Akihito
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Remove Role From User   Asia ReadOnly Admin    Akihito
Remove Role From user Homer
    [Documentation]  Removes Puppet Master from user Homer
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Remove Role From User   Puppet Master    Homer
Delete user Akihito
    [Documentation]  Deletes user Akihito
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Delete User     Akihito
Delete user Homer
    [Documentation]  Deletes user Homer
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Delete User     Homer
Delete Role Asia ReadOnly Admin
    [Documentation]  Deletes Asia ReadOnly Admin
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Delete Role     Asia ReadOnly Admin
Delete Role Puppet Master
    [Documentation]  Deletes Puppet Master
    Login User      ${ADMIN_USER}    ${ADMIN_PASSWD}
    Delete Role     Puppet Master
